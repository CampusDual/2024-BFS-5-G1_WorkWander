<!--
    Este archivo HTML define un formulario para añadir un nuevo espacio de coworking. El formulario está estructurado utilizando componentes de Angular y Flex Layout para un diseño responsivo.
    Detalles del Formulario:
    - Atributos del Formulario:
      - class: "form-section"
      - attr: "coworkingDetail"
      - service: "coworkings"
      - entity: "coworking"
      - keys: "id"
      - header-actions: "new"
      - show-header-navigation: "no"
      - (onInsert): "onInsertSuccess()"
      - after-insert-mode: "detail"
    - Secciones del Formulario:
      - Información General:
        - Nombre: Campo de texto requerido con icono "business"
        - Descripción: Campo de texto requerido con icono "description" y un máximo de 250 caracteres
      - Dirección y Localidad:
        - Localidad: Campo de texto requerido con icono "location_city"
        - Dirección: Campo de texto requerido con icono "place"
      - Capacidad y Precio Diario:
        - Capacidad: Campo de número entero requerido con icono "event_seat" y color de hover personalizado
        - Precio Diario: Campo de número real requerido con icono "euro_symbol", 2 dígitos decimales, y color de hover personalizado
  -->
<o-form
  #coworkingForm
  attr="coworkingDetail"
  service="coworkings"
  entity="coworking"
  keys="id"
  header-actions="new"
  show-header-navigation="no"
  (onInsert)="onInsertSuccess(); $event.stopPropagation()"
  class="form-section form-new-event"
  show-header="no"
  ignore-default-navigation="yes"
  fxFlex
>
  <div
    class="form-section"
    fxLayout="row"
    fxLayoutGap="24px"
    fxLayoutAlign="left start"
  >
    <!-- General Information -->
    <o-column
      fxFlex
      class="form-section form-new-event"
      title="ADD_COWORKING"
      fxLayoutGap="24px"
    >
      <!-- Name and Description-->
      <o-text-input
        fxFlex
        attr="cw_name"
        fxFlex
        label="NAME"
        required="yes"
        icon="business"
        placeholder="{{ 'COWORKINGS_NAME' | oTranslate }}"
        max-length="25"
        min-length="3"
      ></o-text-input>
      <o-textarea-input
        fxFlex
        attr="cw_description"
        fxFlex
        label="DESCRIPTION"
        required="yes"
        icon="description"
        max-length="250"
        icon="description"
        placeholder="{{ 'COWORKINGS_DESCRIPTION' | oTranslate }}"
      ></o-textarea-input>
      <!-- Direction and Locality -->
      <o-combo
        #combo
        attr="cw_location"
        service="cities"
        entity="city"
        keys="id_city"
        value-column="id_city"
        columns="id_city;city"
        visible-columns="city"
        null-selection="no"
        required="yes"
        label="LOCATION"
        translate="yes"
        searchable="true"
        sort="ASC"
        appearance="fill"
        (onChange)="onMunicipalityChange()">
      >
      </o-combo>
      <o-text-input
        fxFlex
        #address
        attr="cw_address"
        fxFlex
        label="ADDRESS"
        required="yes"
        icon="place"
        placeholder="{{ 'COWORKINGS_ADDRESS' | oTranslate }}"
        max-length="50"
        min-length="3"
        (onBlur)="onAddressBlur()"
      ></o-text-input>
      <!-- Capacity and Price -->
      <o-integer-input
        min="1"
        max="1000"
        attr="cw_capacity"
        label="CAPACITY"
        required="yes"
        icon="event_seat"
        placeholder="{{ 'COWORKINGS_CAPACITY' | oTranslate }}"
        style="--field-hover-color: #6200ea"
      ></o-integer-input>
      <o-real-input
        min="1"
        max="1000"
        attr="cw_daily_price"
        label="DAILY_PRICE"
        required="yes"
        decimal-digits="2"
        icon="euro_symbol"
        placeholder="{{ 'COWORKINGS_PRICE' | oTranslate }}"
        style="--field-hover-color: #6200ea"
        class="price"
      ></o-real-input>

      <span
        >{{ "selected_services" | oTranslate }} {{ selectedServices }} / 6</span
      >
      <o-grid
        attr="services"
        service="services"
        entity="service"
        cols="6"
        #servicesGrid
        columns="srv_id;srv_name"
        keys="srv_id"
        quick-filter="no"
        fixed-header="no"
        controls="false"
        refresh-button="false"
        show-page-size="false"
        pagination-controls="false"
        show-buttons-text="no"
        gutter-size="2px"
        detail-mode="none"
        show-footer="no"
        grid-item-height="70px"
      >
        <o-grid-item *ngFor="let dato of servicesGrid.dataArray">
          <div
            class="srv"
            (click)="selectService(dato.srv_id, 'sel' + dato.srv_id)"
            title="{{ dato.srv_name | oTranslate }}"
          >
            <o-column
              id="{{ 'sel' + dato.srv_id }}"
              class="serviceDisable service-column"
              fxFlex="65px"
            >
              <article *ngIf="dato.srv_name == 'additional_screen'">
                <mat-icon>desktop_windows</mat-icon>
              </article>
              <article *ngIf="dato.srv_name == 'vending_machine'">
                <mat-icon>kitchen</mat-icon>
              </article>
              <article *ngIf="dato.srv_name == 'coffee_bar'">
                <mat-icon>local_cafe</mat-icon>
              </article>
              <article *ngIf="dato.srv_name == 'water_dispenser'">
                <mat-icon>local_drink</mat-icon>
              </article>
              <article *ngIf="dato.srv_name == 'ergonomic_chair'">
                <mat-icon>event_seat</mat-icon>
              </article>
              <article *ngIf="dato.srv_name == 'parking'">
                <mat-icon>local_parking</mat-icon>
              </article>
            </o-column>
          </div>
        </o-grid-item>
      </o-grid>
    </o-column>
    <o-column
      fxFlex
      class="form-section form-new-event"
      title=""
      fxLayoutGap="24px"
    >
      <div title="" fxLayoutGap="24px" class="columna-imagen-mapa">
        <!-- Imagen Information -->
        <!-- Imagen -->
        <o-image
          attr="cw_image"
          sql-type="OTHER"
          max-file-size="1048576"
        ></o-image>
        <!-- Map Information -->
        <o-map
          #oMapBasic
          attr="coworking_map"
          [center]=center
          [zoom]=zoom
          min-zoom="3"
          max-zoom="20"
          zoom-control="yes"
          search-control="no"
          fxFlex
        ></o-map>
      </div>
    </o-column>
  </div>
  <div
    fxLayout="row"
    fxLayoutGap="24px"
    class="form-row"
    fxFlex
    fxLayoutAlign="end"
    fxLayoutGap="30px"
    class="buttons"
  >
    <button mat-raised-button color="warn" (click)="cancel()">
      {{ "cancel" | oTranslate }}
    </button>
    <button
      mat-raised-button
      color="primary"
      [disabled]="isInvalidForm()"
      attr="save"
      (click)="save()"
    >
      {{ "save" | oTranslate }}
    </button>
  </div>
</o-form>
